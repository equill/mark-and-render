Partway there: I've implemented handling of the first level of lists, with reasonably graceful failure modes.
