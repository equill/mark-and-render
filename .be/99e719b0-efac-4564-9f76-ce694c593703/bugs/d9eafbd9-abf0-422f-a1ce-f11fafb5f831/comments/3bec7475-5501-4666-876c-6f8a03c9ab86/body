I think we're going to have to drop the third level of nesting from the scope of this ticket, and regard it as a nice-to-have, to be implemented later.
